{"remainingRequest":"F:\\myblob\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\myblob\\vue-element-admin\\src\\views\\table\\inline-edit-table.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\myblob\\vue-element-admin\\src\\views\\table\\inline-edit-table.vue","mtime":1574149531351},{"path":"F:\\myblob\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\myblob\\vue-element-admin\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\myblob\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\myblob\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\myblob\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { getOwnerInfo } from \"@/api/table\";\r\nexport default {\r\n  name: \"messageboard\",\r\n  data() {\r\n    var checkUsername = (rule, value, callback) => {\r\n      var reg = new RegExp(/^([a-zA-Z0-9-\\u4e00-\\u9fa5]+)$/);\r\n      if (!reg.test(value)) {\r\n        callback(new Error(\"请输入正确的姓名\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    var checkPhone = (rule, value, callback) => {\r\n      var reg = new RegExp(/^[1][3,4,5,6,7,8,9][0-9]{9}$/);\r\n      if (!reg.test(value)) {\r\n        callback(new Error(\"请输入正确的电话\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    var checkCarNo = (rule, value, callback) => {\r\n      if (!value) {\r\n        callback();\r\n      } else {\r\n        var reg = new RegExp(\r\n          /^[鲁京津沪渝冀晋辽吉黑苏浙皖闽赣豫鄂湘粤琼川贵云陕甘青藏桂蒙宁新]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$/\r\n        );\r\n        if (!reg.test(value)) {\r\n          callback(new Error(\"请输入正确的车牌号\"));\r\n        } else {\r\n          callback();\r\n        }\r\n      }\r\n    };\r\n    return {\r\n      listLoading: false, //\r\n      pageInfo: {\r\n        //分页\r\n        currentPage: 1,\r\n        pageSize: 10,\r\n        pageTotal: 80\r\n      },\r\n      id: \"\",\r\n      formSearch: {\r\n        // 状态\r\n        nstatus: \"-1\",\r\n        //表单查询\r\n        username: \"\",\r\n        phone: \"\",\r\n        carNo: \"\"\r\n      },\r\n      formDect: {\r\n        dectNo: \"\"\r\n      },\r\n      formDesc: {\r\n        desc1: \"\",\r\n        desc2: \"\",\r\n        desc3: \"\"\r\n      },\r\n      dectNo: \"\",\r\n      formDectEdit: {\r\n        username: \"\",\r\n        date: \"\",\r\n        time: \"\"\r\n      },\r\n      formEdit: {\r\n        //表单编辑\r\n      },\r\n      addFormVisible: false,\r\n      userList: [],\r\n      isDisabled: false,\r\n      formDectTitle: \"检测单号\", //\r\n      formDectDisabled: false, //\r\n      formDescTitle: \"活动详情\", //\r\n      formDescDisabled: false, //\r\n      dialogDescVisible: false,\r\n      dialogDectVisible: false, //编辑弹框显示\r\n      dialogDectVisibleEdit: false,\r\n      dialogType: \"\", //弹框类型：add,edit,show\r\n      tableData: [],\r\n      labelPosition: \"right\", //lable对齐方式\r\n      labelWidth: \"80px\", //lable宽度\r\n      multipleSelection: [],\r\n      rules: {\r\n        username: [\r\n          { validator: checkUsername, trigger: \"change\" },\r\n          { required: true, message: \"请输入姓名\", trigger: \"blur\" }\r\n        ],\r\n        phone: [\r\n          { validator: checkPhone, trigger: \"change\" },\r\n          { required: true, message: \"请输入电话\", trigger: \"blur\" }\r\n        ],\r\n        carNo: [{ validator: checkCarNo, trigger: \"change\" }]\r\n      }\r\n    };\r\n  },\r\n  computed: {},\r\n  filters: {\r\n    convertType: function(type) {\r\n      if (type == 1) {\r\n        return \"留言\";\r\n      } else if (type == 2) {\r\n        return \"建议\";\r\n      } else if (type == 3) {\r\n        return \"BUG\";\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    // 搜索\r\n    this.onSearch();\r\n  },\r\n  methods: {\r\n    handleEditDesc() {\r\n      this.dialogDescVisible = true;\r\n    },\r\n    dectIsShow(nstatus) {\r\n      //\r\n      this.formDect.dectNo = \"\";\r\n      var status = true;\r\n      if (parseInt(nstatus) == 1) {\r\n        status = false;\r\n      }\r\n      return status;\r\n    },\r\n    /**\r\n     * 查询列表\r\n     */\r\n    onSearch(currentPage) {\r\n      if (currentPage) {\r\n        this.pageInfo.currentPage = 1;\r\n      }\r\n      this.listLoading = true;\r\n      let param = Object.assign({}, this.formSearch, this.pageInfo);\r\n      getOwnerInfo(param)\r\n        .then(data => {\r\n          this.listLoading = false;\r\n          console.log(\"表格执行到这里了\");\r\n          if (data) {\r\n            var json = data;\r\n            if (json.result.resultCode == \"0\") {\r\n              this.pageInfo.pageTotal = json.total;\r\n              //this.pageInfo.currentPage = json.pageCount;\r\n              this.tableData = json.userInfos;\r\n              console.log(json.userInfos);\r\n            } else if (json.message) {\r\n              this.$message({ message: json.message, type: \"error\" });\r\n            }\r\n          }\r\n        })\r\n        .catch(err => {\r\n          this.listLoading = false;\r\n          this.$message({ message: \"查询异常，请重试\", type: \"error\" });\r\n        });\r\n    },\r\n    //领取操作弹窗\r\n    handleDect(index, rowData) {\r\n      this.id = rowData.id;\r\n      this.dialogDectVisible = true;\r\n      this.$nextTick(() => {\r\n        this.formDectTitle = \"检测单号\";\r\n        this.formDectDisabled = false;\r\n      });\r\n    },\r\n    // 编辑信息内容\r\n    handleDectEdit(index, rowData) {\r\n      this.id = rowData.id;\r\n      // 深拷贝处理\r\n      this.formDectEdit = window.JSON.parse(window.JSON.stringify(rowData));\r\n      // 记录dectNo\r\n      this.dectNo = window.JSON.parse(window.JSON.stringify(rowData.dectNo));\r\n      var timestr = rowData.signUpTime.split(\" \");\r\n      // this.formDectEdit.newDate = new Date(timestr[0]);\r\n      // this.formDectEdit.newTime = new Date(2016, 9, 10, 8, 40, 50);\r\n      var ymd = timestr[0].split(\"-\");\r\n      var hms = timestr[1].split(\":\");\r\n      this.formDectEdit.signUpTime = new Date(\r\n        ymd[0],\r\n        parseInt(ymd[1]) - 1,\r\n        ymd[2],\r\n        hms[0],\r\n        hms[1],\r\n        hms[2]\r\n      );\r\n      this.dialogDectVisibleEdit = true;\r\n      // 设置单号框的状态\r\n      this.isDisabled = parseInt(this.formDectEdit.nstatus) == 1 ? false : true;\r\n      this.$nextTick(() => {\r\n        this.formDectTitle = \"编辑报名信息\";\r\n        this.formDectDisabled = false;\r\n      });\r\n    },\r\n    // 领取操作\r\n    formDectSubmit() {\r\n      if (!this.formDect.dectNo) {\r\n        this.$message({ message: \"请填写检测单号\", type: \"error\" });\r\n        return false;\r\n      }\r\n      apis.msgApi\r\n        .changeStutas({ id: this.id, dectNo: this.formDect.dectNo })\r\n        .then(data => {\r\n          if (data && data.data) {\r\n            var json = data.data;\r\n            if (json && json.result.resultCode == \"0\") {\r\n              this.$message({ message: \"领取成功\", type: \"success\" });\r\n              this.dialogDectVisible = false;\r\n              this.onSearch();\r\n              return;\r\n            } else {\r\n              this.$message({\r\n                message: json.result.resultDesc,\r\n                type: \"error\"\r\n              });\r\n            }\r\n          }\r\n        })\r\n        .catch(err => {\r\n          debugger;\r\n          this.$message({ message: \"执行失败，请重试\", type: \"error\" });\r\n        });\r\n    },\r\n    /**\r\n     * 删除\r\n     */\r\n    handleDelete(index, rowData) {\r\n      var id = rowData.id;\r\n      console.log(id);\r\n      this.$confirm(\"确定删除该条信息, 是否继续?\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\"\r\n      })\r\n        .then(() => {\r\n          apis.msgApi\r\n            .deleteInfo({ id: id })\r\n            .then(data => {\r\n              if (data && data.data) {\r\n                var json = data.data;\r\n                if (json && json.result.resultCode == \"0\") {\r\n                  this.$message({ message: \"删除信息成功\", type: \"success\" });\r\n                  this.dialogDectVisible = false;\r\n                  this.onSearch();\r\n                  return;\r\n                }\r\n              }\r\n              this.$message({ message: \"执行失败，请重试\", type: \"error\" });\r\n            })\r\n            .catch(err => {\r\n              debugger;\r\n              this.$message({ message: \"执行失败，请重试\", type: \"error\" });\r\n            });\r\n        })\r\n        .catch(() => {\r\n          this.$message({ type: \"info\", message: \"已取消删除\" });\r\n        });\r\n    },\r\n    selectNstatus(e) {\r\n      //状态赋值\r\n      this.formDectEdit.nstatus = e;\r\n      if (e == \"1\") {\r\n        //选择了已领取\r\n        this.isDisabled = false;\r\n        this.formDectEdit.dectNo = this.dectNo;\r\n      } else {\r\n        // 未领取\r\n        this.formDectEdit.dectNo = \"\";\r\n        this.isDisabled = true;\r\n      }\r\n    },\r\n    // 修改操作\r\n    formDectEditSubmit(formName) {\r\n      this.$refs[formName].validate(valid => {\r\n        //校验\r\n        if (valid) {\r\n          if (\r\n            parseInt(this.formDectEdit.nstatus) == 1 &&\r\n            !this.formDectEdit.dectNo\r\n          ) {\r\n            this.$message({ message: \"请填写检测单号\", type: \"error\" });\r\n            return false;\r\n          }\r\n          apis.msgApi\r\n            .editInfo({ id: this.id, dataEdit: this.formDectEdit })\r\n            .then(data => {\r\n              if (data && data.data) {\r\n                var json = data.data;\r\n                if (json && json.result.resultCode == \"0\") {\r\n                  this.$message({ message: \"修改信息成功\", type: \"success\" });\r\n                  this.onSearch();\r\n                  this.dialogDectVisibleEdit = false;\r\n                  return;\r\n                }\r\n              }\r\n              this.$message({ message: json.result.resultDesc, type: \"error\" });\r\n            })\r\n            .catch(err => {\r\n              debugger;\r\n              this.$message({ message: \"执行失败，请重试\", type: \"error\" });\r\n            });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    formDescSubmit() {\r\n      if (this.formDesc.desc1 && this.formDesc.desc2 && this.formDesc.desc3) {\r\n        apis.msgApi\r\n          .editDesc({ desc: this.formDesc })\r\n          .then(data => {\r\n            if (data && data.data) {\r\n              var json = data.data;\r\n              if (json && json.result.resultCode == \"0\") {\r\n                this.$message({ message: \"修改活动信息成功\", type: \"success\" });\r\n                this.dialogDescVisible = false;\r\n                return;\r\n              }\r\n            }\r\n            this.$message({ message: json.result.resultDesc, type: \"error\" });\r\n          })\r\n          .catch(err => {\r\n            debugger;\r\n            this.$message({ message: \"执行失败，请重试\", type: \"error\" });\r\n          });\r\n      } else {\r\n        this.$message({ message: \"请填写活动详情\", type: \"error\" });\r\n        return false;\r\n      }\r\n    },\r\n    getDesc() {\r\n      var that = this;\r\n      apis.msgApi\r\n        .getDesc({})\r\n        .then(data => {\r\n          if (data && data.data) {\r\n            var json = data.data;\r\n            if (json && json.result.resultCode == \"0\") {\r\n              that.formDesc = json.descInfo[0];\r\n              that.dialogDescVisible = true;\r\n            }\r\n          }\r\n        })\r\n        .catch(err => {\r\n          debugger;\r\n          this.$message({ message: \"执行失败，请重试\", type: \"error\" });\r\n        });\r\n    },\r\n    onReset() {\r\n      this.$refs[\"formSearch\"].resetFields();\r\n    },\r\n    /**\r\n     * 关闭弹框，数据重置\r\n     */\r\n    closeDialog(formName) {\r\n      //this.$refs[formName].resetFields();\r\n    },\r\n    /**\r\n     * 分页大小切换\r\n     */\r\n    handleSizeChange(val) {\r\n      this.pageInfo.pageSize = val;\r\n      this.onSearch();\r\n    },\r\n    /**\r\n     * 分页切换\r\n     */\r\n    handleCurrentChange(val) {\r\n      this.pageInfo.currentPage = val;\r\n      this.onSearch();\r\n    },\r\n    /**\r\n     * 点击选择\r\n     */\r\n    handleSelectionChange(val) {\r\n      var ids = [];\r\n      // for (var i = 0; i < val.length; i++) {\r\n      //   if (val[i].tiId) {\r\n      //     ids.push(val[i].tiId);\r\n      //   }\r\n      // }\r\n      var idsStr = ids.join(\",\");\r\n      //this.multipleSelection = val;\r\n      this.ids = idsStr;\r\n      // this.$message({\r\n      //     message: '选中的项是:' + JSON.stringify(this.multipleSelection),\r\n      //     type: \"success\"\r\n      // });\r\n    },\r\n    /**\r\n     * 打开详情页\r\n     */\r\n    openDetail(row) {\r\n      this.$common.OpenNewPage(this, \"detail\", row);\r\n    }\r\n  }\r\n};\r\n",null]}